define(["services/sulucomment/comment-manager","services/sulucomment/comment-router","text!./list.html"],function(a,b,c){var d={templates:{list:c},translations:{title:"sulu_comment.comments"}};return{defaults:d,header:function(){return{title:this.translations.title,underline:!1,noBack:!0,toolbar:{buttons:{deleteSelected:{options:{callback:function(){this.sandbox.emit("husky.datagrid.comments.items.get-selected",this.deleteItems.bind(this))}.bind(this)}},"export":{options:{url:"/admin/api/comments.csv"}}}}}},layout:{content:{width:"max"}},initialize:function(){this.render(),this.bindCustomEvents()},render:function(){this.$el.html(this.templates.list()),this.sandbox.sulu.initListToolbarAndList.call(this,"comments",a.url()+"/fields",{el:this.$find("#list-toolbar-container"),instanceName:"comments",template:this.sandbox.sulu.buttons.get({settings:{options:{dropdownItems:[{type:"columnOptions"}]}}})},{el:this.sandbox.dom.find("#comments-list"),url:a.url()+"?sortBy=created&sortOrder=desc",searchInstanceName:"comments",searchFields:["title"],resultKey:"comments",instanceName:"comments",actionCallback:function(a){b.toEdit(a)},contentFilters:{message:function(a){var b=document.createElement("div");return b.innerHTML=a,a=b.textContent||b.innerText,this.sandbox.util.cropMiddle(a,300)}.bind(this)},viewOptions:{table:{selectItem:{type:"checkbox",inFirstCell:!1}}}})},deleteItems:function(b){this.sandbox.emit("sulu.header.toolbar.item.loading","deleteSelected"),a.deleteMultiple(b).then(function(){for(var a in b)this.sandbox.emit("husky.datagrid.comments.record.remove",b[a]);this.sandbox.emit("sulu.header.toolbar.item.disable","deleteSelected")}.bind(this))},bindCustomEvents:function(){this.sandbox.on("husky.datagrid.comments.number.selections",function(a){var b=a>0?"enable":"disable";this.sandbox.emit("sulu.header.toolbar.item."+b,"deleteSelected",!1)}.bind(this))}}});